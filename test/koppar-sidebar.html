<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="../bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>
    <script src="../bower_components/web-component-tester/browser.js"></script>
    <link rel="import" href="../bower_components/koppar-elements/sidebar/koppar-sidebar.html">
    <style>
      test-fixture {
        position: static;
      }
    </style>
  </head>
  <body>
    <test-fixture id="koppar-sidebar">
      <template>
        <koppar-sidebar></koppar-sidebar>
      </template>
    </test-fixture>
    <script>
      suite("<koppar-sidebar>", function() {
        var sidebar;
        setup(function() {
          sidebar = fixture("koppar-sidebar");
          sidebar.responsiveBreakpoint = 1000;
        });
        test("Should not be fixed and not open when sidebar.offsetWidth < sidebar.responsiveBreakpoint", function() {
          sidebar.style.width = "999px";

          var event = new Event("resize");
          window.dispatchEvent(event);

          assert.isFalse(sidebar.fixed);
          assert.isFalse(sidebar.opened);
        });
        test("Should not be fixed and not open when sidebar.offsetWidth = sidebar.responsiveBreakpoint", function() {
          sidebar.style.width = "1000px";

          var event = new Event("resize");
          window.dispatchEvent(event);

          assert.isFalse(sidebar.fixed);
          assert.isFalse(sidebar.opened);
        });
        test("Should be fixed and not open when sidebar.offsetWidth > sidebar.responsiveBreakpoint", function() {
          sidebar.style.width = "1001px";

          var event = new Event("resize");
          window.dispatchEvent(event);

          assert.isTrue(sidebar.fixed);
          assert.isFalse(sidebar.opened);
        });

        test("Should open when not fixed", function() {
          sidebar.style.width = "999px";

          var event = new Event("resize");
          window.dispatchEvent(event);

          sidebar.open();
          assert.isFalse(sidebar.fixed);
          assert.isTrue(sidebar.opened);
        });

        test("Should not open when fixed", function() {
          sidebar.style.width = "1001px";

          var event = new Event("resize");
          window.dispatchEvent(event);

          sidebar.open();
          assert.isTrue(sidebar.fixed);
          assert.isFalse(sidebar.opened);
        });

        test("Should close when not fixed and open", function() {
          sidebar.style.width = "999px";

          var event = new Event("resize");
          window.dispatchEvent(event);

          assert.isFalse(sidebar.opened);

          sidebar.open();
          assert.isTrue(sidebar.opened);
          assert.isFalse(sidebar.fixed);

          sidebar.close();
          assert.isFalse(sidebar.opened);
        });

        test("Should close when being fixed", function() {
          sidebar.style.width = "999px";

          var event = new Event("resize");
          window.dispatchEvent(event);

          sidebar.open();
          assert.isFalse(sidebar.fixed);
          assert.isTrue(sidebar.opened);

          sidebar.style.width = "1001px";

          var event = new Event("resize");
          window.dispatchEvent(event);

          assert.isTrue(sidebar.fixed);
          assert.isFalse(sidebar.opened);
        });
      });
      a11ySuite("koppar-sidebar");
    </script>

  </body>
</html>