<!doctype HTML>
<html>
  <head>
    <title>Koppar Elements</title>
    <style>
      html {
        font-family: "Roboto", sans-serif;
        margin: 0; padding: 0; 
        width: 100%;
        min-height: 100vh;
        font-size: 18px;
        -webkit-tap-highlight-color: rgba(0,0,0,0);
        background: #f0f0f0;
        overflow: hidden;
        overflow-y: scroll;
      }

      .nav {
        padding: 16px;
        line-height: 16px;
        box-sizing: border-box;
      }

      body > koppar-router {
        box-sizing: border-box;
        display: block;
        overflow: hidden;
      }

      .flex-grid {
        display: flex;
        flex-wrap: wrap;
        padding: 8px;
        align-items: stretch;
        align-content: stretch;
      }

      .flex-grid > koppar-element-card {
        padding: 8px;
      }

    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="import" href="/bower_components/koppar-elements/test/import.html" async>

    <link rel="prefetch" href="/bower_components/koppar-elements/router/routematcher.js">
    <link rel="prefetch" href="/bower_components/tinycolor/dist/tinycolor-min.js">
    <link rel="prefetch" href="/bower_components/mdi/css/materialdesignicons.min.css">

    <link rel="prefetch" href="/bower_components/koppar-elements/router/koppar-router.html">
    <link rel="prefetch" href="/bower_components/koppar-elements/router/koppar-view.html">

    <link rel="prefetch" href="/bower_components/koppar-elements/behaviors/koppar-selectable-behavior.html">

    <link rel="prefetch" href="/bower_components/koppar-elements/documentation/koppar-element-styles.html">
    <link rel="prefetch" href="/bower_components/koppar-elements/documentation/koppar-element-card.html">
    <link rel="prefetch" href="/bower_components/koppar-elements/documentation/koppar-element-documentation.html">

    <link rel="prefetch" href="/bower_components/koppar-elements/navbar/koppar-navbar.html">
    <link rel="prefetch" href="/bower_components/koppar-elements/navbar/koppar-navbar-action.html">

    <link rel="prefetch" href="/bower_components/koppar-elements/sidebar/koppar-sidebar.html">
    <link rel="prefetch" href="/bower_components/koppar-elements/sidebar/koppar-sidebar-entry.html">
    <link rel="prefetch" href="/bower_components/koppar-elements/sidebar/koppar-sidebar-header.html">
    <link rel="prefetch" href="/bower_components/koppar-elements/sidebar/koppar-sidebar-opener.html">

    <link rel="prefetch" href="/bower_components/koppar-elements/utilities/koppar-icon.html">
    <link rel="prefetch" href="/bower_components/koppar-elements/utilities/koppar-image.html">
  </head>
  <body>
    <koppar-sidebar id="main-sidebar">
      <koppar-sidebar-header></koppar-sidebar-header>
      <koppar-sidebar-entry href="/" icon="rocket" text="Home"></koppar-sidebar-entry>
      <koppar-sidebar-entry href="/elements/" icon="code-tags" text="Elements">
        <koppar-sidebar-entry href="/elements/navbar/" select-route="/elements/navbar/*" text="Navbar elements"></koppar-sidebar-entry>
        <koppar-sidebar-entry href="/elements/sidebar/" select-route="/elements/sidebar/*" text="Sidebar elements"></koppar-sidebar-entry>
      </koppar-sidebar-entry>
    </koppar-sidebar>

    <koppar-router route="/" transition="fade" greedy> <!-- greedy makes this router only use one view -->
      <koppar-view route="/" order="1">
        <template>
          <koppar-navbar title="koppar-elements">
            <koppar-sidebar-opener sidebar-selector="#main-sidebar"></koppar-sidebar-opener>
          </koppar-navbar>
          <h1>Welcome</h1>
        </template>
      </koppar-view>
      
      <koppar-view route="/elements" order="2"> <!-- lazy matches EVERYTHING after -->
        <template>
          <koppar-navbar title="Elements">
            <koppar-sidebar-opener sidebar-selector="#main-sidebar"></koppar-sidebar-opener>
          </koppar-navbar>
          <div class="flex-grid">
            <koppar-element-card title="navbar" href="/elements/navbar/">Navbar elements</koppar-element-card>
            <koppar-element-card title="sidebar" href="/elements/sidebar/">Sidebar elements</koppar-element-card>
          </div>
        </template>
      </koppar-view>

      <koppar-view route="/elements/navbar" lazy order="3"> <!-- lazy matches EVERYTHING after -->
        <template>
          <koppar-navbar title="Navbar Elements">
            <koppar-sidebar-opener sidebar-selector="#main-sidebar"></koppar-sidebar-opener>
          </koppar-navbar>
          <koppar-router route="/elements/navbar" transition="fade" greedy>
            <koppar-view route="/" order="1">
              <template>
                <div class="flex-grid">
                  <koppar-element-card title="koppar-navbar" href="/elements/navbar/koppar-navbar/">The navbar wrapper</koppar-element-card>
                  <koppar-element-card title="koppar-navbar-action" href="/elements/navbar/koppar-navbar-action/">An action residing in the navbar</koppar-element-card>
                </div>
              </template>
            </koppar-view>
            <koppar-view route="/koppar-navbar" order="1">
              <template>
                <koppar-element-documentation title="koppar-navbar">
                  <koppar-doc-description>

                  </koppar-doc-description>
                </koppar-element-documentation>
              </template>
            </koppar-view>
            <koppar-view route="/koppar-navbar-action" order="2">
              <template>
                <koppar-element-documentation title="koppar-navbar-action">
                  
                </koppar-element-documentation>
              </template>
            </koppar-view>
          </koppar-router>
        </template>
      </koppar-view>

      <koppar-view route="/elements/sidebar" lazy order="4"> <!-- lazy matches EVERYTHING after -->
        <template>
          <koppar-navbar title="Sidebar Elements">
            <koppar-sidebar-opener sidebar-selector="#main-sidebar"></koppar-sidebar-opener>
          </koppar-navbar>
          <koppar-router route="/elements/sidebar" transition="fade" greedy>
            <koppar-view route="/" order="1">
              <template>
                <div class="flex-grid">
                  <koppar-element-card title="koppar-sidebar" href="/elements/sidebar/koppar-sidebar/">The sidebar element</koppar-element-card>
                  <koppar-element-card title="koppar-sidebar-entry" href="/elements/sidebar/koppar-sidebar-entry/">A link for the sidebar</koppar-element-card>
                  <koppar-element-card title="koppar-sidebar-header" href="/elements/sidebar/koppar-sidebar-header/">A sidebar header</koppar-element-card>
                </div>
              </template>
            </koppar-view>
            <koppar-view route="/koppar-sidebar" order="2">
              <template>
                <koppar-sidebar-doc></koppar-sidebar-doc>
              </template>
            </koppar-view>
            <koppar-view route="/koppar-sidebar-entry" order="3">
              <template>
                <koppar-sidebar-entry-doc></koppar-sidebar-entry-doc>
              </template>
            </koppar-view>
            <koppar-view route="/koppar-sidebar-header" order="3">
              <template>
                <koppar-sidebar-header-doc></koppar-sidebar-header-doc>
              </template>
            </koppar-view>
            <koppar-view route="/koppar-sidebar-opener" order="4">
              <template>
                <h1>koppar-sidebar-opener</h1>
              </template>
            </koppar-view>
          </koppar-router>
        </template>
      </koppar-view>
    </koppar-router>

    <script>
      window.performance && performance.mark && performance.mark("index.html");
      Polymer = {lazyRegister: true, dom: "shadow"};
      (function() {
        if ("registerElement" in document
            && "import" in document.createElement("link")
            && "content" in document.createElement("template")) {
          // platform is good!
        } else {
          // polyfill the platform!
          var e = document.createElement("script");
          e.src = "/bower_components/webcomponentsjs/webcomponents-lite.min.js";
          e.defer = true;
          document.body.appendChild(e);
        }
      })();

      (function() {
        var marks = {

        };

        var durations = {

        };
        
        var dateStart = Date.now();
        window.__performance = window.__performance || {};

        var hasNativePerformanceNow = "performance" in window && "now" in window.performance;
        window.__performance.now = function() {
          if(hasNativePerformanceNow) return window.performance.now();
          return Date.now() - dateStart;
        };
        var hasNativePerformanceMark = "performance" in window && "mark" in window.performance;
        window.__performance.mark = function(str) { 
          marks[str] = window.performance.now();

          if(hasNativePerformanceMark) window.performance.mark(str);
        };
        var hasNativePerformanceMeasure = "performance" in window && "measure" in window.performance;
        window.__performance.measure = function(name, startEntry, endEntry) { 
          var start = marks[startEntry];
          var end = marks[endEntry];

          var duration = end - start;
          durations[name] = duration;

          if("ga" in window) {
            ga("send", {
              hitType: "timing",
              timingCategory: "User Timings",
              timingVar: "name",
              timingValue: duration
            });
          }
          if(hasNativePerformanceMeasure) window.performance.measure(name, startEntry, endEntry);
        };
      })();

      function sendEvent() {
        window.__performance.mark("navigationstart");

        // Create the event
        var event = new CustomEvent("location-changed", {});

        // Dispatch/Trigger/Fire the event
        window.dispatchEvent(event);

        window.__performance.mark("navigationend");
        window.__performance.measure("Navigation Event", "navigationstart", "navigationend");
      }

      var navigations = 0;
      document.body.addEventListener("click", function(evt) {
        if(evt.target.hasAttribute("href")) {
          evt.preventDefault();
          
          var url = evt.target.getAttribute("href");

          if(window.location.pathname === url) return;
          console.info("Navigating to " + url);

          history.pushState(null, null, url);

          sendEvent();
        }
      });

      window.addEventListener("popstate", function(evt) {
        sendEvent();
      });
    </script>
  </body>
</html>
