<link rel="import" href="../../polymer/polymer.html">

<dom-module is="koppar-navbar-action">
  <template>
    <style>
      :host {
        position: relative;
        display: block;
        width: 40px;
        height: 40px;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        border-radius: 20px;
        overflow: hidden;

        cursor: pointer;
      }
      
      :host svg,
      :host ::content svg {
        position: absolute;
        top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        width: 24px;
        height: 24px;
      }
      :host #top, :host #middle, :host #bottom {
        transform-origin: left center;
        transition: transform 0.2s, opacity 0.2s;
        will-change: transform, opacity;
      }
      :host([icon="menu"]) #top{
        transform: none;
        opacity: 1;
      }
      :host([icon="menu"]) #bottom{
        transform: none;
        opacity: 1;
      }
      :host([icon="menu"]) #middle {
        transform: none;
        opacity: 1;
      }

      :host([icon="close"]) #top{
        transform: translate3d(2px, -2px, 0) rotate(45deg) scale3d(1.1, 1, 1);
      }
      :host([icon="close"]) #bottom{
        transform: translate3d(2px, 2px, 0) rotate(-45deg) scale3d(1.1, 1, 1);
      }
      :host([icon="close"]) #middle {
        opacity: 0;
      }

      :host(:not([show])) {
        pointer-events: none;
      }

      :host svg,
      :host ::content svg {
        transform: translate3d(-50%, -50%, 0) scale3d(0,0,0);
        opacity: 0;

        transition: opacity 225ms, transform 225ms;
        transition-delay: 225;
      }
      :host([show]) svg,
      :host([show]) ::content svg {
        transform: translate3d(-50%, -50%, 0)  scale3d(1,1,1);
        opacity: 1;
        transition-delay: 450ms;
      }

    </style>
    <content></content>
    <template is="dom-if" if="{{icon}}">
      <svg viewBox="0 0 24 24">
        <path fill="currentColor" d="M3,6H21V8H3V6" id="top"></path>
        <path fill="currentColor" d="M3,11H21V13H3V11" id="middle"></path>
        <path fill="currentColor" d="M3,16H21V18H3V16Z" id="bottom"></path>
      </svg>
    </template>
    <paper-ripple id="ripple"></paper-ripple>
    
  </template>
  <script>
    Polymer({
      is: "koppar-navbar-action",
      created: function() {
        this.removeAttribute("unresolved");
      },
      properties: {
        icon: {
          type: String,
          observer: "_checkIcon",
          reflectToAttribute: true
        },
        show: {
          type: Boolean,
          observer: "_showChanged",
          value: true,
          reflectToAttribute: true
        }
      },
      listeners: {
        "tap": "_tap",
        "ripple.transitionend": "_transitionend"
      },
      _tap: function() {

      },
      _transitionend: function() {
        this.fire("rippleend");
      },
      _checkIcon: function(newIcon, oldIcon) {
        var allowed = [
          "close",
          "menu"
        ];

        if(allowed.indexOf(newIcon) < 0) {
          this.icon = oldIcon;
        }
      },
      _showChanged: function() {
        this.fire("showchange");
      }
    })
  </script>
</dom-module>

